{% extends "base.html" %}
{% block content %}

<h1 class="mb-4">Gestion des vermifuges</h1>
<p class="text-muted mb-4">
  Configurez ici les types de vermifuges utilisables pour les chats.
</p>

<div class="row g-4">

  <!-- ------ COLONNE GAUCHE : AJOUT ------ -->
  <div class="col-lg-5">
    <div class="card">
      <div class="card-header">Ajouter un type de vermifuge</div>
      <div class="card-body">
        <form action="{{ url_for('add_deworming_type') }}" method="post">
          <div class="mb-3">
            <label class="form-label">Nom</label>
            <input type="text"
                   name="name"
                   class="form-control"
                   placeholder="Ex : Milbemax"
                   required>
          </div>

          <button class="btn btn-primary">Ajouter</button>
        </form>
      </div>
    </div>
  </div>

  <!-- ------ COLONNE DROITE : LISTE ------ -->
  <div class="col-lg-7">
    <div class="card">
      <div class="card-header">Liste</div>

      {% if types %}
      <ul class="list-group list-group-flush">

        {% for d in types %}
        <li class="list-group-item">

          <div class="d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ d.name }}</strong><br>
              {% if d.is_active %}
                <span class="badge bg-success">Actif</span>
              {% else %}
                <span class="badge bg-secondary">Inactif</span>
              {% endif %}
            </div>

            <div>
              <!-- Bouton modifier -->
              <button class="btn btn-sm btn-outline-primary"
                      data-bs-toggle="collapse"
                      data-bs-target="#edit{{ d.id }}">
                Modifier
              </button>

              <!-- Bouton supprimer -->
              <form action="{{ url_for('delete_deworming_type', type_id=d.id) }}"
                    method="post"
                    class="d-inline"
                    onsubmit="return confirm('Supprimer {{ d.name }} ?')">
                <button class="btn btn-sm btn-outline-danger">Supprimer</button>
              </form>
            </div>
          </div>

          <!-- Zone édition -->
          <div class="collapse mt-3" id="edit{{ d.id }}">
            <form action="{{ url_for('edit_deworming_type', type_id=d.id) }}"
                  method="post"
                  class="border rounded p-3 bg-light">

              <div class="mb-3">
                <label class="form-label">Nom</label>
                <input type="text"
                       name="name"
                       class="form-control"
                       value="{{ d.name }}"
                       required>
              </div>

              <div class="form-check mb-3">
                <input class="form-check-input"
                       type="checkbox"
                       name="is_active"
                       {% if d.is_active %}checked{% endif %}>
                <label class="form-check-label">Actif</label>
              </div>

              <button class="btn btn-primary">Enregistrer</button>
            </form>
          </div>

        </li>
        {% endfor %}

      </ul>

      {% else %}
        <p class="text-muted p-3">Aucun type de vermifuge configuré.</p>
      {% endif %}
    </div>
  </div>

</div>

{% endblock %}
